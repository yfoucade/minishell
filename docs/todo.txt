[] install different handlers depending on whether it is interactive or not.

[] in non-interactive mode, the handler sets a global variable to some value.
after preprocessing a command, check that global variable. If the value indicates
that the program should stop, then free status and exit. Otherwise, execute command
or flush preprocessing error message.